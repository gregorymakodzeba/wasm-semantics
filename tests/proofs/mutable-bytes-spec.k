module MUTABLE-BYTES-SPEC
    imports MUTABLE-BYTES-DEFN

    claim start(.MutableBytes) => end(mutableBytes(0, 16, Zero))
    claim start(padRightBytes(.MutableBytes, 15)) => end(mutableBytes(15, 16, Zero))
    claim start(padRightBytes(.MutableBytes, 32)) => end(mutableBytes(32, 64, Node(16, Zero :: Zero :: Zero :: Zero)))
    claim start(padRightBytes(.MutableBytes, 97))
        => end(mutableBytes(97, 256, Node(64, Node(16, Zero :: Zero :: Zero :: Zero) :: Zero :: Zero :: Zero)))
    claim start(padRightBytes(padRightBytes(.MutableBytes, 97), 32))
        => end(mutableBytes(97, 256, Node(64, Node(16, Zero :: Zero :: Zero :: Zero) :: Zero :: Zero :: Zero)))
    claim start(padRightBytes(padRightBytes(.MutableBytes, 15), 32))
        => end(mutableBytes(32, 64, Node(16, Zero :: Zero :: Zero :: Zero)))

    claim start(replaceAtBytes(padRightBytes(.MutableBytes, 32), 5, b"a"))
        => end(mutableBytes(32, 64, Node(16, Leaf(b"\x00\x00\x00\x00\x00a\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00") :: Zero :: Zero :: Zero)))
    claim start(replaceAtBytes(padRightBytes(.MutableBytes, 32), 21, b"a"))
        => end(mutableBytes(32, 64, Node(16, Zero :: Leaf(b"\x00\x00\x00\x00\x00a\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00") :: Zero :: Zero)))
    claim start(replaceAtBytes(padRightBytes(.MutableBytes, 32), 5, b"12345678901234567890"))
        => end(mutableBytes(32, 64, Node(16, Leaf(b"\x00\x00\x00\x00\x0012345678901") :: Leaf(b"234567890\x00\x00\x00\x00\x00\x00\x00") :: Zero :: Zero)))
    claim start(replaceAtBytes(padRightBytes(.MutableBytes, 16), 5, b"a"))
        => end(mutableBytes(16, 16, Leaf(b"\x00\x00\x00\x00\x00a\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00")))
    claim start(replaceAtBytes(padRightBytes(.MutableBytes, 10), 5, b"a"))
        => end(mutableBytes(10, 16, Leaf(b"\x00\x00\x00\x00\x00a\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00")))

    claim start(substrBytes(padRightBytes(.MutableBytes, 97), 0, 1))
        => end(b"\x00")
    claim start(substrBytes(padRightBytes(.MutableBytes, 97), 15, 16))
        => end(b"\x00")
    claim start(substrBytes(padRightBytes(.MutableBytes, 97), 16, 17))
        => end(b"\x00")
    claim start(substrBytes(padRightBytes(.MutableBytes, 97), 63, 64))
        => end(b"\x00")
    claim start(substrBytes(padRightBytes(.MutableBytes, 97), 64, 65))
        => end(b"\x00")
    claim start(substrBytes(padRightBytes(.MutableBytes, 97), 96, 97))
        => end(b"\x00")
    claim start(substrBytes(padRightBytes(.MutableBytes, 97), 0, 2))
        => end(b"\x00\x00")
    claim start(substrBytes(padRightBytes(.MutableBytes, 97), 15, 17))
        => end(b"\x00\x00")
    claim start(substrBytes(padRightBytes(.MutableBytes, 97), 63, 65))
        => end(b"\x00\x00")
    claim start(substrBytes(padRightBytes(.MutableBytes, 97), 95, 97))
        => end(b"\x00\x00")
    claim start(substrBytes(padRightBytes(.MutableBytes, 97), 0, 32))
        => end(b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00")

    claim start(substrBytes(replaceAtBytes(padRightBytes(.MutableBytes, 32), 5, b"a"), 5, 6))
        => end(b"a")
    claim start(substrBytes(replaceAtBytes(padRightBytes(.MutableBytes, 32), 20, b"a"), 20, 21))
        => end(b"a")
    claim start(substrBytes(replaceAtBytes(padRightBytes(.MutableBytes, 128), 15, b"a"), 15, 16))
        => end(b"a")
    claim start(substrBytes(replaceAtBytes(padRightBytes(.MutableBytes, 128), 16, b"a"), 16, 17))
        => end(b"a")
    claim start(substrBytes(replaceAtBytes(padRightBytes(.MutableBytes, 128), 31, b"a"), 31, 32))
        => end(b"a")
    claim start(substrBytes(replaceAtBytes(padRightBytes(.MutableBytes, 128), 32, b"a"), 32, 33))
        => end(b"a")
    claim start(substrBytes(replaceAtBytes(padRightBytes(.MutableBytes, 128), 63, b"a"), 63, 64))
        => end(b"a")
    claim start(substrBytes(replaceAtBytes(padRightBytes(.MutableBytes, 128), 64, b"a"), 64, 65))
        => end(b"a")

endmodule
